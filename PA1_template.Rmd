---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---
#Summary
This document was produced as the first project for Coursera's Reproducible Research course.

## Loading and preprocessing the data
Package denpendencies are called out, the working directory is set and the data is read from the .csv file.
```{r, echo = TRUE}
  library(dplyr)
  library(ggplot2)
  library(lattice)
  library(lubridate)

  setwd("/Users/mistermaxx/Documents/work/personal/Coursera/Repro_Res/")
  
  # read data from file
  activity.file.data <- read.csv("activity.csv")

```


## What is mean total number of steps taken per day?
The aggregate() function is used to summarize the data.
```{r, echo = TRUE, eval = TRUE}
  # calc distrubtion of steps
  steps.data <- aggregate(steps ~ date, activity.file.data, sum)
```

Using ggplot, a histogram of the data is created.
```{r, echo = TRUE, eval = TRUE}
  #create histogram with ggplot
  histogram.steps.data <- ggplot(data = steps.data, aes(steps.data$steps)) 
  histogram.steps.data + geom_histogram(color = "black", fill = "pink", bins = 10, binwidth = 6000) + labs(x = "Steps", y = "Count", title = "Distribution: Total Steps")
  
    # calc, report mean & median
  mean.steps <- mean(steps.data$steps)
  median.steps <- median(steps.data$steps)
  
  print(mean.steps)
  print(median.steps)

```

## What is the average daily activity pattern?
Calculate the mean of steps per interval.
```{r, echo = TRUE, eval = TRUE}
  # calc mean of steps/interval
  interval.steps.data <- aggregate(steps ~ interval, activity.file.data, mean)
```

Graph the data using ggplot.
```{r, echo = TRUE, eval = TRUE}
  #plot graph using ggplot
   graph.data <- ggplot(interval.steps.data, aes(interval, steps))
   graph.data + geom_line(color = "purple") + labs(x = "Interval", y = "Steps", title = "Steps Per Interval")
```

Calculate which interval has the maximum number of steps
```{r, echo = TRUE, eval = TRUE}
  # max interval
  max.interval.steps <- interval.steps.data[which.max(interval.steps.data$steps), 1]

  print(seconds_to_period(5 * (max.interval.steps) * 60))
```
The interval at Wednesday, 9:35 pm (2 days, 21 hours, 35 minutes) has the highest spike and the maximum number of steps.

## Imputing missing values

```{r, echo = TRUE, eval = TRUE}
  # missing values
  incomplete.data <- sum(!complete.cases(activity.file.data))
```

Use the MICE package to fill in (impute) data (echo is turned off to avoid multiple MICE lines displaying)
```{r, echo = FALSE, eval = TRUE}
  imputed.data <- mice(data = activity.file.data, m = 5, method = "pmm", maxit = 20, seed = 500)
```

Create a histogram from the aggregated data.
```{r, echo = TRUE, eval = TRUE}
  imputed.data[as.character(imputed.data$date) == "2012-10-01", 1] <- 0
  
  imputed.steps.data <- aggregate(steps ~ date, imputed.data, sum)
  hist(imputed.steps.data$steps, main = paste("Total Steps Each Day"), col = "purple", xlab = "Number of Steps")
```

## Are there differences in activity patterns between weekdays and weekends?
